# Sybase 基础

> https://www.cnblogs.com/ixan/p/16488721.html

## 索引

### 查看索引

```
-- 查看索引
sp_helpindex 表名  
-- 查看表\索引:
sp_help 表名 
查看执行计划是否走索引
分析语句执行计划是否走索引
set nocount on
set showplan on
set noexec on
go
 
具体SQL 语句
go
set nocount off
set showplan off
set noexec off
go
```

## 数据库事务

```
数据库在并发情况下，可能会造成数据的更新丢失，脏读，不可重复读，幻读。sybase使用两阶段锁协议
保证事务的隔离性和一致性，两阶段协议指锁的获取阶段和释放阶段，获取阶段包括读取数据时对数据加共
享锁，更新数据时加排他锁，释放阶段指共享锁和排他锁的释放阶段。数据库的隔离级别影响着共享锁的释放时机。

更新丢失: 一个事务对数据的更改被另外一个事务覆盖
脏读: 一个事务读取到另外一个事务未提交的更改
不可重复读：一个事务内查询两次的结果不一致
幻读: 一个事务内查询到另一个事务未提交的插入
sybase中支持四种隔离级别:

级别0：更新数据时加排他锁，读取数据不加锁。不会出现更新丢失，会出现脏读、不可重复读，幻读
级别1：更新数据时加排他锁，读取数据加共享锁，读取完数据释放共享锁。不会出现更新丢失，脏读，会出现不可重复读，幻读
级别2：更新数据时加排他锁，读取数据加共享锁，事务结束释放共享锁。不会出现更新丢失，脏读，不可重复读，会出现幻读
级别3：更新数据时加排他锁和范围锁，读取数据加共享锁，事务结束释放共享锁。不会出现更新丢失，脏读，不可重复读，幻读
```

```sql
-- sybase 查询当前事务隔离级别:  
select @@isolation
```

> 0 读未提交
> 1 读已提交
> 2 可重复读
> 3 可串行化